<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>SOUMNT - Seus vídeos em instantes</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 24px; }
    .row { display: flex; gap: 8px; align-items: center; margin-bottom: 12px; }
    input[type="text"] { flex: 1; padding: 8px; }
    button { padding: 8px 12px; cursor: pointer; }
    #log { height: 220px; overflow: auto; white-space: pre-wrap; background: #111; color: #ddd; padding: 8px; border-radius: 6px; }
    progress { width: 100%; height: 20px; }
    label { min-width: 80px; font-weight: 600; }
    .status { margin: 6px 0; font-weight: 600; }
    small { color: #666; }
  </style>
</head>
<body>
  <h1>SOUMNT - Baixador de vídeos</h1>

  <div class="row">
    <label for="url">URL:</label>
    <input id="url" type="text" placeholder="https://www.youtube.com/watch?v=..." />
  </div>

  <div class="row">
    <label for="outDir">Pasta:</label>
    <input id="outDir" type="text" placeholder="Escolha uma pasta de destino" readonly />
    <button id="choose">Escolher…</button>
  </div>

  <div class="row">
    <label for="format">Formato:</label>
    <input id="format" type="text" placeholder="Ex.: bestvideo+bestaudio/best (opcional)" />
  </div>

  <div class="row">
    <button id="download">Baixar</button>
    <div class="status" id="status"></div>
  </div>

  <progress id="progress" value="0" max="100"></progress>
  <p><small>Dica: instale <code>yt-dlp</code> e <code>ffmpeg</code> no sistema e mantenha no PATH.</small></p>

  <h3>Log</h3>
  <div id="log"></div>

  <script>
    const $ = (id) => document.getElementById(id);
    const statusEl = $("status");
    const logEl = $("log");
    const progress = $("progress");

    $("choose").addEventListener("click", async () => {
      const dir = await window.electronAPI.chooseFolder();
      if (dir) $("outDir").value = dir;
    });

    $("download").addEventListener("click", async () => {
      const url = $("url").value.trim();
      const outDir = $("outDir").value.trim();
      const format = $("format").value.trim();

      if (!url)  return alert("Informe a URL do vídeo.");
      if (!outDir) return alert("Escolha a pasta de destino.");

      progress.value = 0;
      statusEl.textContent = "Baixando…";
      logEl.textContent = "";

      try {
        await window.electronAPI.startDownload({ url, outDir, format });
        statusEl.textContent = "Concluído ✅";
        progress.value = 100;
      } catch (err) {
        statusEl.textContent = "Falhou ❌";
        logEl.textContent += "\nErro: " + err.message;
      }
    });

    window.electronAPI.onProgress((p) => {
      progress.value = p;
    });

    window.electronAPI.onLog((msg) => {
      logEl.textContent += msg;
      logEl.scrollTop = logEl.scrollHeight;
    });
  </script>
</body>
</html>
